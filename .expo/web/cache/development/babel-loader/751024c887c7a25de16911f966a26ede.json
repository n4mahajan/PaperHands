{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Jiahao Luo\\\\Documents\\\\PaperHands\\\\Project\\\\PaperHands\\\\PaperHands\\\\BuySell\\\\BuySell.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useContext } from \"react\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport { AuthContext } from \"../../context/AuthProvider\";\nimport firebase from \"firebase\";\nimport { Directions } from \"react-native-gesture-handler\";\nimport { useEffect } from \"react/cjs/react.development\";\nimport axios from \"axios\";\nimport Chart from \"./Chart\";\nimport moment from \"moment\";\nimport { useNavigation } from '@react-navigation/native';\nexport default function BuySell(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var generateData = function generateData(xValues, yValues) {\n    var currentData = [];\n\n    for (var i = 0; i < yValues.length; i++) {\n      var temp = {\n        x: xValues[i],\n        y: yValues[i]\n      };\n      currentData.push(temp);\n    }\n\n    return currentData;\n  };\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      price = _useState2[0],\n      setPrice = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      amount = _useState4[0],\n      setAmount = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      stockAmount = _useState6[0],\n      setStocks = _useState6[1];\n\n  var _useState7 = useState(route.params.symbol),\n      _useState8 = _slicedToArray(_useState7, 2),\n      symbol = _useState8[0],\n      setSymbol = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      hourData = _useState10[0],\n      setHourData = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      dayData = _useState12[0],\n      setDayData = _useState12[1];\n\n  var _useState13 = useState([]),\n      _useState14 = _slicedToArray(_useState13, 2),\n      monthData = _useState14[0],\n      setMonthData = _useState14[1];\n\n  var _useState15 = useState([]),\n      _useState16 = _slicedToArray(_useState15, 2),\n      yearData = _useState16[0],\n      setYearData = _useState16[1];\n\n  var _useState17 = useState(true),\n      _useState18 = _slicedToArray(_useState17, 2),\n      chartReady = _useState18[0],\n      setChart = _useState18[1];\n\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user,\n      balance = _useContext.balance,\n      stocks = _useContext.stocks;\n\n  var pulledNavigation = useNavigation();\n\n  var finnhub = require('finnhub');\n\n  var api_key = finnhub.ApiClient.instance.authentications['api_key'];\n  api_key.apiKey = \"c54gglaad3ifdcrdm7u0\";\n  var finnhubClient = new finnhub.DefaultApi();\n  var now = moment().unix();\n  var hour = moment().subtract(1, \"hours\").unix();\n  var day = moment().subtract(1, \"days\").unix();\n  var month = moment().subtract(1, \"months\").unix();\n  var year = moment().subtract(1, \"years\").unix();\n  useEffect(function () {\n    function getData() {\n      return _regeneratorRuntime.async(function getData$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(axios.get(\"https://finnhub.io/api/v1/stock/candle?symbol=\" + symbol + \"&resolution=1&from=\" + hour + \"&to=\" + now + \"&token=c54gglaad3ifdcrdm7u0\").then(function (response) {\n                setHourData(generateData(response.data.t, response.data.c));\n              }).catch(function (err) {\n                console.log(err);\n              }));\n\n            case 2:\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(axios.get(\"https://finnhub.io/api/v1/stock/candle?symbol=\" + symbol + \"&resolution=60&from=\" + day + \"&to=\" + now + \"&token=c54gglaad3ifdcrdm7u0\").then(function (response) {\n                setDayData(generateData(response.data.t, response.data.c));\n              }).catch(function (err) {\n                console.log(err);\n              }));\n\n            case 4:\n              _context.next = 6;\n              return _regeneratorRuntime.awrap(axios.get(\"https://finnhub.io/api/v1/stock/candle?symbol=\" + symbol + \"&resolution=D&from=\" + month + \"&to=\" + now + \"&token=c54gglaad3ifdcrdm7u0\").then(function (response) {\n                setMonthData(generateData(response.data.t, response.data.c));\n              }).catch(function (err) {\n                console.log(err);\n              }));\n\n            case 6:\n              _context.next = 8;\n              return _regeneratorRuntime.awrap(axios.get(\"https://finnhub.io/api/v1/stock/candle?symbol=\" + symbol + \"&resolution=W&from=\" + year + \"&to=\" + now + \"&token=c54gglaad3ifdcrdm7u0\").then(function (response) {\n                setYearData(generateData(response.data.t, response.data.c));\n              }).catch(function (err) {\n                console.log(err);\n              }));\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    getData();\n  }, []);\n  useEffect(function () {\n    pulledNavigation.setOptions({\n      title: symbol,\n      headerTitleStyle: {\n        marginRight: 56,\n        marginLeft: 56\n      }\n    });\n  }, []);\n  useEffect(function () {\n    finnhubClient.quote(symbol, function (error, data, response) {\n      var updatedPrice = data.c;\n      setPrice(updatedPrice);\n    });\n  }, []);\n\n  var buy = function buy() {\n    var numberAmount, totalCost;\n    return _regeneratorRuntime.async(function buy$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            numberAmount = parseInt(amount);\n            totalCost = numberAmount * price;\n\n            if (!(balance >= totalCost)) {\n              _context2.next = 6;\n              break;\n            }\n\n            if (stocks.hasOwnProperty(symbol)) {\n              stocks[symbol] += numberAmount;\n            } else {\n              stocks[symbol] = numberAmount;\n            }\n\n            _context2.next = 6;\n            return _regeneratorRuntime.awrap(firebase.firestore().collection(\"Users\").doc(user.uid).update({\n              stocks: stocks,\n              balance: balance - totalCost\n            }));\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var sell = function sell() {\n    var numberAmount, totalGain;\n    return _regeneratorRuntime.async(function sell$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            numberAmount = parseInt(amount);\n            totalGain = numberAmount * price;\n\n            if (!stocks.hasOwnProperty(symbol)) {\n              _context3.next = 13;\n              break;\n            }\n\n            if (!(stocks[symbol] >= numberAmount)) {\n              _context3.next = 10;\n              break;\n            }\n\n            stocks[symbol] -= numberAmount;\n\n            if (stocks[symbol] <= 0) {\n              delete stocks[symbol];\n            }\n\n            _context3.next = 8;\n            return _regeneratorRuntime.awrap(firebase.firestore().collection(\"Users\").doc(user.uid).update({\n              stocks: stocks,\n              balance: balance + totalGain\n            }));\n\n          case 8:\n            _context3.next = 11;\n            break;\n\n          case 10:\n            Alert.alert('You dont own enough of this stock');\n\n          case 11:\n            _context3.next = 14;\n            break;\n\n          case 13:\n            Alert.alert('You dont own any shares of this stock');\n\n          case 14:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(TouchableWithoutFeedback, {\n    onPress: Keyboard.dismiss,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 3\n    }\n  }, React.createElement(View, {\n    style: {\n      flex: 1,\n      background: \"blue\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 2\n    }\n  }, React.createElement(View, {\n    style: styles.priceContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 3\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 4\n    }\n  }, symbol, \" Price: $\", price)), React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 3\n    }\n  }, React.createElement(Chart, {\n    hourData: hourData,\n    dayData: dayData,\n    monthData: monthData,\n    yearData: yearData,\n    symbol: symbol,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 4\n    }\n  })), React.createElement(View, {\n    style: styles.input,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 3\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 4\n    }\n  }, \"Enter amount of shares:\"), React.createElement(TextInput, {\n    placeholder: \"Amount\",\n    onChangeText: setAmount,\n    style: styles.textInput,\n    keyboardType: \"numeric\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 4\n    }\n  })), React.createElement(View, {\n    style: {\n      flex: 1,\n      flexDirection: \"row\",\n      alignContent: \"center\",\n      justifyContent: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 3\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return Alert.alert(\"Are you sure you want to buy?\", \"\", [{\n        text: \"Confirm\",\n        onPress: function onPress() {\n          buy();\n          navigation.goBack();\n        }\n      }, {\n        text: \"Deny\",\n        onPress: function onPress() {\n          return console.log(\"Transaction Voided\");\n        }\n      }]);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 3\n    }\n  }, React.createElement(View, {\n    style: styles.button,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 4\n    }\n  }, React.createElement(Text, {\n    style: styles.buttonText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 5\n    }\n  }, \" Buy\"))), React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return Alert.alert(\"Are you sure you want to sell?\", \"\", [{\n        text: \"Confirm\",\n        onPress: function onPress() {\n          sell();\n          navigation.goBack();\n        }\n      }, {\n        text: \"Deny\",\n        onPress: function onPress() {\n          return console.log(\"Transaction Voided\");\n        }\n      }]);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 3\n    }\n  }, React.createElement(View, {\n    style: styles.button,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 4\n    }\n  }, React.createElement(Text, {\n    style: styles.buttonText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 5\n    }\n  }, \" Sell\"))))));\n}\nvar styles = StyleSheet.create({\n  priceContainer: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    top: 25\n  },\n  input: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: \"5%\",\n    marginTop: \"15%\"\n  },\n  button: {\n    borderRadius: 8,\n    paddingVertical: 14,\n    paddingHorizontal: 10,\n    backgroundColor: 'black',\n    width: 100,\n    height: 50\n  },\n  buttonText: {\n    color: 'white',\n    fontWeight: 'bold',\n    textTransform: 'uppercase',\n    fontSize: 16,\n    textAlign: 'center'\n  },\n  textInput: {\n    height: 40,\n    borderColor: \"#000000\",\n    borderBottomWidth: 1,\n    marginBottom: 36\n  },\n  inner: {\n    padding: 24,\n    flex: 1,\n    justifyContent: \"space-around\"\n  }\n});","map":{"version":3,"sources":["C:/Users/Jiahao Luo/Documents/PaperHands/Project/PaperHands/PaperHands/BuySell/BuySell.js"],"names":["React","useState","useContext","AuthContext","firebase","Directions","useEffect","axios","Chart","moment","useNavigation","BuySell","navigation","route","generateData","xValues","yValues","currentData","i","length","temp","x","y","push","price","setPrice","amount","setAmount","stockAmount","setStocks","params","symbol","setSymbol","hourData","setHourData","dayData","setDayData","monthData","setMonthData","yearData","setYearData","chartReady","setChart","user","balance","stocks","pulledNavigation","finnhub","require","api_key","ApiClient","instance","authentications","apiKey","finnhubClient","DefaultApi","now","unix","hour","subtract","day","month","year","getData","get","then","response","data","t","c","catch","err","console","log","setOptions","title","headerTitleStyle","marginRight","marginLeft","quote","error","updatedPrice","buy","numberAmount","parseInt","totalCost","hasOwnProperty","firestore","collection","doc","uid","update","sell","totalGain","Alert","alert","Keyboard","dismiss","flex","background","styles","priceContainer","input","textInput","flexDirection","alignContent","justifyContent","text","onPress","goBack","button","buttonText","StyleSheet","create","alignItems","top","marginBottom","marginTop","borderRadius","paddingVertical","paddingHorizontal","backgroundColor","width","height","color","fontWeight","textTransform","fontSize","textAlign","borderColor","borderBottomWidth","inner","padding"],"mappings":";;;AAQA,OAAOA,KAAP,IAAeC,QAAf,EAAwBC,UAAxB,QAAyC,OAAzC;;;;;;;;;;;AAGA,SAASC,WAAT;AACA,OAAOC,QAAP,MAAqB,UAArB;AACA,SAASC,UAAT,QAA2B,8BAA3B;AACA,SAASC,SAAT,QAA0B,6BAA1B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,SAAQC,aAAR,QAA4B,0BAA5B;AAEA,eAAe,SAASC,OAAT,OAAuC;AAAA,MAApBC,UAAoB,QAApBA,UAAoB;AAAA,MAARC,KAAQ,QAARA,KAAQ;;AACrD,MAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,OAAD,EAAUC,OAAV,EAAsB;AAC1C,QAAMC,WAAW,GAAG,EAApB;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,OAAO,CAACG,MAA5B,EAAoCD,CAAC,EAArC,EAAwC;AACvC,UAAIE,IAAI,GAAG;AAAEC,QAAAA,CAAC,EAACN,OAAO,CAACG,CAAD,CAAX;AAAgBI,QAAAA,CAAC,EAACN,OAAO,CAACE,CAAD;AAAzB,OAAX;AACAD,MAAAA,WAAW,CAACM,IAAZ,CAAiBH,IAAjB;AACA;;AACD,WAAOH,WAAP;AACA,GAPD;;AASA,kBAA0BhB,QAAQ,CAAC,CAAD,CAAlC;AAAA;AAAA,MAAOuB,KAAP;AAAA,MAAcC,QAAd;;AACA,mBAA4BxB,QAAQ,EAApC;AAAA;AAAA,MAAOyB,MAAP;AAAA,MAAeC,SAAf;;AACA,mBAAiC1B,QAAQ,EAAzC;AAAA;AAAA,MAAO2B,WAAP;AAAA,MAAoBC,SAApB;;AACA,mBAA4B5B,QAAQ,CAACY,KAAK,CAACiB,MAAN,CAAaC,MAAd,CAApC;AAAA;AAAA,MAAOA,MAAP;AAAA,MAAeC,SAAf;;AACA,mBAAgC/B,QAAQ,CAAC,EAAD,CAAxC;AAAA;AAAA,MAAOgC,QAAP;AAAA,MAAiBC,WAAjB;;AACA,oBAA8BjC,QAAQ,CAAC,EAAD,CAAtC;AAAA;AAAA,MAAOkC,OAAP;AAAA,MAAgBC,UAAhB;;AACA,oBAAkCnC,QAAQ,CAAC,EAAD,CAA1C;AAAA;AAAA,MAAOoC,SAAP;AAAA,MAAkBC,YAAlB;;AACA,oBAAgCrC,QAAQ,CAAC,EAAD,CAAxC;AAAA;AAAA,MAAOsC,QAAP;AAAA,MAAiBC,WAAjB;;AACA,oBAA+BvC,QAAQ,CAAC,IAAD,CAAvC;AAAA;AAAA,MAAOwC,UAAP;AAAA,MAAmBC,QAAnB;;AACA,oBAA4BxC,UAAU,CAACC,WAAD,CAAtC;AAAA,MAAOwC,IAAP,eAAOA,IAAP;AAAA,MAAYC,OAAZ,eAAYA,OAAZ;AAAA,MAAoBC,MAApB,eAAoBA,MAApB;;AACA,MAAMC,gBAAgB,GAAGpC,aAAa,EAAtC;;AAEA,MAAMqC,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AAEA,MAAMC,OAAO,GAAGF,OAAO,CAACG,SAAR,CAAkBC,QAAlB,CAA2BC,eAA3B,CAA2C,SAA3C,CAAhB;AACAH,EAAAA,OAAO,CAACI,MAAR,GAAiB,sBAAjB;AACA,MAAMC,aAAa,GAAG,IAAIP,OAAO,CAACQ,UAAZ,EAAtB;AACA,MAAMC,GAAG,GAAG/C,MAAM,GAAGgD,IAAT,EAAZ;AACA,MAAMC,IAAI,GAAGjD,MAAM,GAAGkD,QAAT,CAAkB,CAAlB,EAAqB,OAArB,EAA8BF,IAA9B,EAAb;AACA,MAAMG,GAAG,GAAGnD,MAAM,GAAGkD,QAAT,CAAkB,CAAlB,EAAqB,MAArB,EAA6BF,IAA7B,EAAZ;AACA,MAAMI,KAAK,GAAGpD,MAAM,GAAGkD,QAAT,CAAkB,CAAlB,EAAqB,QAArB,EAA+BF,IAA/B,EAAd;AACA,MAAMK,IAAI,GAAGrD,MAAM,GAAGkD,QAAT,CAAkB,CAAlB,EAAqB,OAArB,EAA8BF,IAA9B,EAAb;AAEAnD,EAAAA,SAAS,CAAC,YAAM;AACf,aAAeyD,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CACOxD,KAAK,CAACyD,GAAN,oDAA2DjC,MAA3D,2BAAuF2B,IAAvF,YAAkGF,GAAlG,kCAAoIS,IAApI,CAAyI,UAACC,QAAD,EAAc;AAC5JhC,gBAAAA,WAAW,CAACpB,YAAY,CAACoD,QAAQ,CAACC,IAAT,CAAcC,CAAf,EAAkBF,QAAQ,CAACC,IAAT,CAAcE,CAAhC,CAAb,CAAX;AACA,eAFK,EAEHC,KAFG,CAEG,UAAAC,GAAG,EAAI;AACfC,gBAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACA,eAJK,CADP;;AAAA;AAAA;AAAA,+CAOOhE,KAAK,CAACyD,GAAN,oDAA2DjC,MAA3D,4BAAwF6B,GAAxF,YAAkGJ,GAAlG,kCAAoIS,IAApI,CAAyI,UAACC,QAAD,EAAc;AAC5J9B,gBAAAA,UAAU,CAACtB,YAAY,CAACoD,QAAQ,CAACC,IAAT,CAAcC,CAAf,EAAkBF,QAAQ,CAACC,IAAT,CAAcE,CAAhC,CAAb,CAAV;AACA,eAFK,EAEHC,KAFG,CAEG,UAAAC,GAAG,EAAI;AACfC,gBAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACA,eAJK,CAPP;;AAAA;AAAA;AAAA,+CAaOhE,KAAK,CAACyD,GAAN,oDAA2DjC,MAA3D,2BAAuF8B,KAAvF,YAAmGL,GAAnG,kCAAqIS,IAArI,CAA0I,UAACC,QAAD,EAAc;AAC7J5B,gBAAAA,YAAY,CAACxB,YAAY,CAACoD,QAAQ,CAACC,IAAT,CAAcC,CAAf,EAAkBF,QAAQ,CAACC,IAAT,CAAcE,CAAhC,CAAb,CAAZ;AACA,eAFK,EAEHC,KAFG,CAEG,UAAAC,GAAG,EAAI;AACfC,gBAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACA,eAJK,CAbP;;AAAA;AAAA;AAAA,+CAmBOhE,KAAK,CAACyD,GAAN,oDAA2DjC,MAA3D,2BAAuF+B,IAAvF,YAAkGN,GAAlG,kCAAoIS,IAApI,CAAyI,UAACC,QAAD,EAAc;AAC5J1B,gBAAAA,WAAW,CAAC1B,YAAY,CAACoD,QAAQ,CAACC,IAAT,CAAcC,CAAf,EAAkBF,QAAQ,CAACC,IAAT,CAAcE,CAAhC,CAAb,CAAX;AACA,eAFK,EAEHC,KAFG,CAEG,UAAAC,GAAG,EAAI;AACfC,gBAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACA,eAJK,CAnBP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAyBAR,IAAAA,OAAO;AACP,GA3BQ,EA2BN,EA3BM,CAAT;AA6BAzD,EAAAA,SAAS,CAAC,YAAI;AACbwC,IAAAA,gBAAgB,CAAC4B,UAAjB,CAA4B;AAC3BC,MAAAA,KAAK,EAAE5C,MADoB;AAE3B6C,MAAAA,gBAAgB,EAAE;AAACC,QAAAA,WAAW,EAAE,EAAd;AAAkBC,QAAAA,UAAU,EAAE;AAA9B;AAFS,KAA5B;AAIA,GALQ,EAKP,EALO,CAAT;AAOAxE,EAAAA,SAAS,CAAC,YAAM;AACfgD,IAAAA,aAAa,CAACyB,KAAd,CAAoBhD,MAApB,EAA4B,UAACiD,KAAD,EAAQb,IAAR,EAAcD,QAAd,EAA2B;AAEtD,UAAMe,YAAY,GAAGd,IAAI,CAACE,CAA1B;AACA5C,MAAAA,QAAQ,CAACwD,YAAD,CAAR;AACA,KAJD;AAKA,GANQ,EAMN,EANM,CAAT;;AAQA,MAAMC,GAAG,GAAC,SAAJA,GAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAEHC,YAAAA,YAFG,GAEUC,QAAQ,CAAC1D,MAAD,CAFlB;AAGH2D,YAAAA,SAHG,GAGQF,YAAY,GAAC3D,KAHrB;;AAAA,kBAILoB,OAAO,IAAEyC,SAJJ;AAAA;AAAA;AAAA;;AAKR,gBAAGxC,MAAM,CAACyC,cAAP,CAAsBvD,MAAtB,CAAH,EAAiC;AAChCc,cAAAA,MAAM,CAACd,MAAD,CAAN,IAAgBoD,YAAhB;AACA,aAFD,MAEK;AACJtC,cAAAA,MAAM,CAACd,MAAD,CAAN,GAAeoD,YAAf;AACA;;AATO;AAAA,6CAUF/E,QAAQ,CAACmF,SAAT,GAAqBC,UAArB,CAAgC,OAAhC,EAAyCC,GAAzC,CAA6C9C,IAAI,CAAC+C,GAAlD,EAAuDC,MAAvD,CAA8D;AACnE9C,cAAAA,MAAM,EAACA,MAD4D;AAEnED,cAAAA,OAAO,EAACA,OAAO,GAACyC;AAFmD,aAA9D,CAVE;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAV;;AAiBA,MAAMO,IAAI,GAAC,SAALA,IAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AACJT,YAAAA,YADI,GACSC,QAAQ,CAAC1D,MAAD,CADjB;AAEJmE,YAAAA,SAFI,GAEOV,YAAY,GAAC3D,KAFpB;;AAAA,iBAGPqB,MAAM,CAACyC,cAAP,CAAsBvD,MAAtB,CAHO;AAAA;AAAA;AAAA;;AAAA,kBAINc,MAAM,CAACd,MAAD,CAAN,IAAgBoD,YAJV;AAAA;AAAA;AAAA;;AAKRtC,YAAAA,MAAM,CAACd,MAAD,CAAN,IAAgBoD,YAAhB;;AACA,gBAAItC,MAAM,CAACd,MAAD,CAAN,IAAgB,CAApB,EAAsB;AACrB,qBAAOc,MAAM,CAACd,MAAD,CAAb;AACA;;AARO;AAAA,6CASF3B,QAAQ,CAACmF,SAAT,GAAqBC,UAArB,CAAgC,OAAhC,EAAyCC,GAAzC,CAA6C9C,IAAI,CAAC+C,GAAlD,EAAuDC,MAAvD,CAA8D;AACnE9C,cAAAA,MAAM,EAACA,MAD4D;AAEnED,cAAAA,OAAO,EAACA,OAAO,GAACiD;AAFmD,aAA9D,CATE;;AAAA;AAAA;AAAA;;AAAA;AAcRC,YAAAA,KAAK,CAACC,KAAN,CAAY,mCAAZ;;AAdQ;AAAA;AAAA;;AAAA;AAkBTD,YAAAA,KAAK,CAACC,KAAN,CAAY,uCAAZ;;AAlBS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAX;;AAsBA,SACC,oBAAC,wBAAD;AAA0B,IAAA,OAAO,EAAEC,QAAQ,CAACC,OAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACD,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAI;AACdC,MAAAA,IAAI,EAAE,CADQ;AAEdC,MAAAA,UAAU,EAAE;AAFE,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAMC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAIC,MAAM,CAACC,cAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACEtE,MADF,eACmBP,KADnB,CADD,CAND,EAWC,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC,oBAAC,KAAD;AACC,IAAA,QAAQ,EAAIS,QADb;AAEC,IAAA,OAAO,EAAIE,OAFZ;AAGC,IAAA,SAAS,EAAIE,SAHd;AAIC,IAAA,QAAQ,EAAIE,QAJb;AAKC,IAAA,MAAM,EAAIR,MALX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,CAXD,EAqBC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAIqE,MAAM,CAACE,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BADD,EAIC,oBAAC,SAAD;AAAW,IAAA,WAAW,EAAC,QAAvB;AAAgC,IAAA,YAAY,EAAE3E,SAA9C;AAAyD,IAAA,KAAK,EAAEyE,MAAM,CAACG,SAAvE;AAAkF,IAAA,YAAY,EAAC,SAA/F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJD,CArBD,EA2BC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAI;AACdL,MAAAA,IAAI,EAAE,CADQ;AAEdM,MAAAA,aAAa,EAAE,KAFD;AAGdC,MAAAA,YAAY,EAAE,QAHA;AAIdC,MAAAA,cAAc,EAAE;AAJF,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAMA,oBAAC,gBAAD;AACC,IAAA,OAAO,EAAE;AAAA,aACTZ,KAAK,CAACC,KAAN,CAAY,+BAAZ,EAA6C,EAA7C,EAAiD,CAChD;AAACY,QAAAA,IAAI,EAAE,SAAP;AAAkBC,QAAAA,OAAO,EAAE,mBAAM;AAChC1B,UAAAA,GAAG;AACHtE,UAAAA,UAAU,CAACiG,MAAX;AACA;AAHD,OADgD,EAKhD;AAACF,QAAAA,IAAI,EAAE,MAAP;AAAeC,QAAAA,OAAO,EAAE;AAAA,iBAAMpC,OAAO,CAACC,GAAR,CAAY,oBAAZ,CAAN;AAAA;AAAxB,OALgD,CAAjD,CADS;AAAA,KADV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KASC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE2B,MAAM,CAACU,MAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEV,MAAM,CAACW,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADD,CATD,CANA,EAoBA,oBAAC,gBAAD;AACC,IAAA,OAAO,EAAE;AAAA,aACTjB,KAAK,CAACC,KAAN,CAAY,gCAAZ,EAA8C,EAA9C,EAAkD,CACjD;AAACY,QAAAA,IAAI,EAAE,SAAP;AAAkBC,QAAAA,OAAO,EAAE,mBAAM;AAChChB,UAAAA,IAAI;AACJhF,UAAAA,UAAU,CAACiG,MAAX;AACA;AAHD,OADiD,EAKjD;AAACF,QAAAA,IAAI,EAAE,MAAP;AAAeC,QAAAA,OAAO,EAAE;AAAA,iBAAMpC,OAAO,CAACC,GAAR,CAAY,oBAAZ,CAAN;AAAA;AAAxB,OALiD,CAAlD,CADS;AAAA,KADV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KASC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE2B,MAAM,CAACU,MAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEV,MAAM,CAACW,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADD,CATD,CApBA,CA3BD,CADC,CADD;AAwEA;AAED,IAAMX,MAAM,GAAGY,UAAU,CAACC,MAAX,CAAmB;AACjCZ,EAAAA,cAAc,EAAE;AACfH,IAAAA,IAAI,EAAE,CADS;AAEfgB,IAAAA,UAAU,EAAE,QAFG;AAGfR,IAAAA,cAAc,EAAE,QAHD;AAIfS,IAAAA,GAAG,EAAE;AAJU,GADiB;AAOjCb,EAAAA,KAAK,EAAE;AACNJ,IAAAA,IAAI,EAAE,CADA;AAENgB,IAAAA,UAAU,EAAE,QAFN;AAGNR,IAAAA,cAAc,EAAE,QAHV;AAINU,IAAAA,YAAY,EAAE,IAJR;AAKNC,IAAAA,SAAS,EAAE;AALL,GAP0B;AAcjCP,EAAAA,MAAM,EAAE;AACPQ,IAAAA,YAAY,EAAE,CADP;AAEPC,IAAAA,eAAe,EAAE,EAFV;AAGPC,IAAAA,iBAAiB,EAAE,EAHZ;AAIPC,IAAAA,eAAe,EAAE,OAJV;AAKPC,IAAAA,KAAK,EAAE,GALA;AAMPC,IAAAA,MAAM,EAAE;AAND,GAdyB;AAsBjCZ,EAAAA,UAAU,EAAE;AACXa,IAAAA,KAAK,EAAE,OADI;AAEXC,IAAAA,UAAU,EAAE,MAFD;AAGXC,IAAAA,aAAa,EAAE,WAHJ;AAIXC,IAAAA,QAAQ,EAAE,EAJC;AAKXC,IAAAA,SAAS,EAAE;AALA,GAtBqB;AA6BjCzB,EAAAA,SAAS,EAAE;AACVoB,IAAAA,MAAM,EAAE,EADE;AAEVM,IAAAA,WAAW,EAAE,SAFH;AAGVC,IAAAA,iBAAiB,EAAE,CAHT;AAIVd,IAAAA,YAAY,EAAE;AAJJ,GA7BsB;AAmC/Be,EAAAA,KAAK,EAAE;AACRC,IAAAA,OAAO,EAAE,EADD;AAERlC,IAAAA,IAAI,EAAE,CAFE;AAGRQ,IAAAA,cAAc,EAAE;AAHR;AAnCwB,CAAnB,CAAf","sourcesContent":["//\r\n//  BuySell\r\n//  PaperHands\r\n//\r\n//  Created by Nikhil, Kiran, Jiahao.\r\n//  Copyright Â© 2018 [Company]. All rights reserved.\r\n//\r\n\r\nimport React, {useState,useContext} from \"react\"\r\nimport { Image, StyleSheet, Text, View, Button, Alert, TextInput, TouchableOpacity,\r\n\tTouchableWithoutFeedback,Keyboard} from \"react-native\"\r\nimport { AuthContext } from \"../../context/AuthProvider\"\r\nimport firebase from \"firebase\"\r\nimport { Directions } from \"react-native-gesture-handler\";\r\nimport { useEffect } from \"react/cjs/react.development\";\r\nimport axios from \"axios\";\r\nimport Chart from \"./Chart\";\r\nimport moment from \"moment\";\r\nimport {useNavigation} from '@react-navigation/native';\r\n\r\nexport default function BuySell ({navigation, route}) {\r\n\tconst generateData = (xValues, yValues) => {\r\n\t\tconst currentData = []\r\n\t\tfor (var i = 0; i < yValues.length; i++){\r\n\t\t\tlet temp = { x:xValues[i], y:yValues[i]}\r\n\t\t\tcurrentData.push(temp)\r\n\t\t}\r\n\t\treturn currentData\r\n\t}\r\n\r\n\tconst [price, setPrice] = useState(0)\r\n\tconst [amount, setAmount] = useState()\r\n\tconst [stockAmount, setStocks] = useState()\r\n\tconst [symbol, setSymbol] = useState(route.params.symbol)\r\n\tconst [hourData, setHourData] = useState([])\r\n\tconst [dayData, setDayData] = useState([])\r\n\tconst [monthData, setMonthData] = useState([])\r\n\tconst [yearData, setYearData] = useState([])\r\n\tconst [chartReady, setChart] = useState(true)\r\n\tconst {user,balance,stocks}=useContext(AuthContext)\r\n\tconst pulledNavigation = useNavigation();\r\n\r\n\tconst finnhub = require('finnhub');\r\n\r\n\tconst api_key = finnhub.ApiClient.instance.authentications['api_key'];\r\n\tapi_key.apiKey = \"c54gglaad3ifdcrdm7u0\"\r\n\tconst finnhubClient = new finnhub.DefaultApi()\r\n\tconst now = moment().unix()\r\n\tconst hour = moment().subtract(1, \"hours\").unix()\r\n\tconst day = moment().subtract(1, \"days\").unix()\r\n\tconst month = moment().subtract(1, \"months\").unix()\r\n\tconst year = moment().subtract(1, \"years\").unix()\r\n\r\n\tuseEffect(() => {\r\n\t\tasync function getData() {\r\n\t\t\tawait axios.get(`https://finnhub.io/api/v1/stock/candle?symbol=${symbol}&resolution=1&from=${hour}&to=${now}&token=c54gglaad3ifdcrdm7u0`).then((response) => {\r\n\t\t\t\tsetHourData(generateData(response.data.t, response.data.c))\r\n\t\t\t}).catch(err => {\r\n\t\t\t\tconsole.log(err)\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\tawait axios.get(`https://finnhub.io/api/v1/stock/candle?symbol=${symbol}&resolution=60&from=${day}&to=${now}&token=c54gglaad3ifdcrdm7u0`).then((response) => {\r\n\t\t\t\tsetDayData(generateData(response.data.t, response.data.c))\r\n\t\t\t}).catch(err => {\r\n\t\t\t\tconsole.log(err)\r\n\t\t\t})\r\n\r\n\t\t\tawait axios.get(`https://finnhub.io/api/v1/stock/candle?symbol=${symbol}&resolution=D&from=${month}&to=${now}&token=c54gglaad3ifdcrdm7u0`).then((response) => {\r\n\t\t\t\tsetMonthData(generateData(response.data.t, response.data.c))\r\n\t\t\t}).catch(err => {\r\n\t\t\t\tconsole.log(err)\r\n\t\t\t})\r\n\r\n\t\t\tawait axios.get(`https://finnhub.io/api/v1/stock/candle?symbol=${symbol}&resolution=W&from=${year}&to=${now}&token=c54gglaad3ifdcrdm7u0`).then((response) => {\r\n\t\t\t\tsetYearData(generateData(response.data.t, response.data.c))\r\n\t\t\t}).catch(err => {\r\n\t\t\t\tconsole.log(err)\r\n\t\t\t})\r\n\t\t}\r\n\t\tgetData()\r\n\t}, [])\r\n\r\n\tuseEffect(()=>{\r\n\t\tpulledNavigation.setOptions({\r\n\t\t\ttitle: symbol,\r\n\t\t\theaderTitleStyle: {marginRight: 56, marginLeft: 56},\r\n\t\t  });\r\n\t},[])\r\n\r\n\tuseEffect(() => {\r\n\t\tfinnhubClient.quote(symbol, (error, data, response) => {\r\n\t\t\t// console.log(data)\r\n\t\t\tconst updatedPrice = data.c\r\n\t\t\tsetPrice(updatedPrice)\r\n\t\t})\r\n\t}, [])\r\n\r\n\tconst buy=async()=>{\r\n\t\t\r\n\t\tconst numberAmount=parseInt(amount)\r\n\t\tconst totalCost= numberAmount*price\r\n\t\tif (balance>=totalCost){\r\n\t\t\tif(stocks.hasOwnProperty(symbol)){\r\n\t\t\t\tstocks[symbol]+=numberAmount\r\n\t\t\t}else{\r\n\t\t\t\tstocks[symbol]=numberAmount\r\n\t\t\t}\r\n\t\t\tawait firebase.firestore().collection(\"Users\").doc(user.uid).update({\r\n\t\t\t\tstocks:stocks,\r\n\t\t\t\tbalance:balance-totalCost\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst sell=async()=>{\r\n\t\tconst numberAmount=parseInt(amount)\r\n\t\tconst totalGain= numberAmount*price\r\n\t\tif(stocks.hasOwnProperty(symbol)){\r\n\t\t\tif(stocks[symbol]>=numberAmount){\r\n\t\t\t\tstocks[symbol]-=numberAmount\r\n\t\t\t\tif (stocks[symbol]<=0){\r\n\t\t\t\t\tdelete stocks[symbol]\r\n\t\t\t\t}\r\n\t\t\t\tawait firebase.firestore().collection(\"Users\").doc(user.uid).update({\r\n\t\t\t\t\tstocks:stocks,\r\n\t\t\t\t\tbalance:balance+totalGain\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n\t\t\t\tAlert.alert('You dont own enough of this stock')\r\n\t\t\t}\r\n\r\n\t\t}else{\r\n\t\t\tAlert.alert('You dont own any shares of this stock')\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<TouchableWithoutFeedback onPress={Keyboard.dismiss}>\r\n\t<View style = {{\r\n\t\tflex: 1,\r\n\t\tbackground: \"blue\",\r\n\t}}>\r\n\t\t\r\n\t\t\r\n\t\t<View style = {styles.priceContainer}>\r\n\t\t\t<Text >\r\n\t\t\t\t{symbol} Price: ${price}\r\n\t\t\t</Text>\t\r\n\t\t</View>\r\n\t\t<View>\r\n\t\t\t<Chart \r\n\t\t\t\thourData = {hourData}\r\n\t\t\t\tdayData = {dayData}\r\n\t\t\t\tmonthData = {monthData}\r\n\t\t\t\tyearData = {yearData}\r\n\t\t\t\tsymbol = {symbol}\r\n\t\t\t/>\r\n\t\t</View>\r\n\t\t\r\n\t\t<View style = {styles.input}>\r\n\t\t\t<Text>\r\n\t\t\t\tEnter amount of shares:\t\r\n\t\t\t</Text>\r\n\t\t\t<TextInput placeholder=\"Amount\" onChangeText={setAmount} style={styles.textInput} keyboardType=\"numeric\"/>\r\n\t\t</View>\r\n\t\t<View style = {{\r\n\t\t\tflex: 1,\r\n\t\t\tflexDirection: \"row\",\r\n\t\t\talignContent: \"center\",\r\n\t\t\tjustifyContent: \"center\",\r\n\t\t}}>\r\n\t\t<TouchableOpacity \t\t\t\r\n\t\t\tonPress={() => \r\n\t\t\tAlert.alert(\"Are you sure you want to buy?\", \"\", [\r\n\t\t\t\t{text: \"Confirm\", onPress: () => {\r\n\t\t\t\t\tbuy()\r\n\t\t\t\t\tnavigation.goBack()\r\n\t\t\t\t}},\r\n\t\t\t\t{text: \"Deny\", onPress: () => console.log(\"Transaction Voided\")},\r\n\t\t\t])}   >\r\n\t\t\t<View style={styles.button}>\r\n\t\t\t\t<Text style={styles.buttonText}> Buy</Text>\r\n\t\t\t</View>\r\n\t\t</TouchableOpacity>\r\n\r\n\t\t<TouchableOpacity \t\t\t\r\n\t\t\tonPress={() => \r\n\t\t\tAlert.alert(\"Are you sure you want to sell?\", \"\", [\r\n\t\t\t\t{text: \"Confirm\", onPress: () => {\r\n\t\t\t\t\tsell()\r\n\t\t\t\t\tnavigation.goBack()\r\n\t\t\t\t}},\r\n\t\t\t\t{text: \"Deny\", onPress: () => console.log(\"Transaction Voided\")},\r\n\t\t\t])}   >\r\n\t\t\t<View style={styles.button}>\r\n\t\t\t\t<Text style={styles.buttonText}> Sell</Text>\r\n\t\t\t</View>\r\n\t\t</TouchableOpacity>\r\n\t\t\r\n\t\t\r\n\r\n\t\t</View>\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t</View>\r\n\t</TouchableWithoutFeedback>\r\n\t)\r\n}\r\n\r\nconst styles = StyleSheet.create( {\r\n\tpriceContainer: {\r\n\t\tflex: 1,\r\n\t\talignItems: \"center\",\r\n\t\tjustifyContent: \"center\",\r\n\t\ttop: 25,\r\n\t},\r\n\tinput: {\r\n\t\tflex: 1,\r\n\t\talignItems: \"center\",\r\n\t\tjustifyContent: \"center\",\r\n\t\tmarginBottom: \"5%\",\r\n\t\tmarginTop: \"15%\"\r\n\t},\r\n\tbutton: {\r\n\t\tborderRadius: 8,\r\n\t\tpaddingVertical: 14,\r\n\t\tpaddingHorizontal: 10,\r\n\t\tbackgroundColor: 'black',\r\n\t\twidth: 100,\r\n\t\theight: 50\r\n\t  },\r\n\tbuttonText: {\r\n\t\tcolor: 'white',\r\n\t\tfontWeight: 'bold',\r\n\t\ttextTransform: 'uppercase',\r\n\t\tfontSize: 16,\r\n\t\ttextAlign: 'center'\r\n\t},\r\n\ttextInput: {\r\n\t\theight: 40,\r\n\t\tborderColor: \"#000000\",\r\n\t\tborderBottomWidth: 1,\r\n\t\tmarginBottom: 36\r\n\t  },\r\n\t  inner: {\r\n\t\tpadding: 24,\r\n\t\tflex: 1,\r\n\t\tjustifyContent: \"space-around\"\r\n\t  },\r\n\t  \r\n\t  \r\n});\r\n"]},"metadata":{},"sourceType":"module"}